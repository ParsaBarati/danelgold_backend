{"version":3,"sources":["../../../src/common/utils/user-agent.util.ts"],"sourcesContent":["import * as useragent from 'express-useragent';\r\n\r\nexport async function getUserOS(req: any) {\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown';\r\n  }\r\n\r\n  const userAgent = useragent.parse(userAgentString);\r\n  let deviceType;\r\n\r\n  switch (true) {\r\n    case userAgent.isMobile:\r\n      deviceType = 'Mobile';\r\n      break;\r\n    case userAgent.isTablet:\r\n      deviceType = 'Tablet';\r\n      break;\r\n    case userAgent.isChromeOS:\r\n      deviceType = 'Chrome OS';\r\n      break;\r\n    case userAgent.isMac:\r\n      deviceType = 'macOS';\r\n      break;\r\n    case userAgent.isDesktop:\r\n      deviceType = 'Desktop';\r\n      break;\r\n    case userAgent.isiPad:\r\n      deviceType = 'iPad';\r\n      break;\r\n    case userAgent.isLinux:\r\n      deviceType = 'Linux';\r\n      break;\r\n    case userAgent.isSmartTV:\r\n      deviceType = 'Smart TV';\r\n      break;\r\n    default:\r\n      deviceType = 'Unknown';\r\n      break;\r\n  }\r\n\r\n  return deviceType;\r\n}\r\n\r\nexport async function getUserSource(req: any) {\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown';\r\n  }\r\n\r\n  const userAgent = useragent.parse(userAgentString);\r\n  return userAgent.source.toString();\r\n}\r\n\r\nexport async function getDeviceVersion(req: any) {\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown';\r\n  }\r\n\r\n  const userAgent = useragent.parse(userAgentString);\r\n  return userAgent.version.toString();\r\n}\r\n\r\nexport async function getBrowserVersion(req: any) {\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown';\r\n  }\r\n\r\n  const userAgent = useragent.parse(userAgentString);\r\n  return `${userAgent.browser}/${userAgent.version}`;\r\n}\r\n\r\nexport async function getUserIP(req: any) {\r\n  return req.headers['x-forwarded-for'] || req.connection.remoteAddress || 'Unknown';\r\n}\r\n\r\nexport async function getUserBrowser(req: any) {\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown';\r\n  }\r\n\r\n  const userAgent = useragent.parse(userAgentString);\r\n  return userAgent.browser.toString();\r\n}\r\n\r\nexport async function getVersionPlatform(req: any) {\r\n  const platformVersion = req.headers['sec-ch-ua-platform-version'];\r\n  const model = req.headers['sec-ch-ua-model'];\r\n\r\n  if (platformVersion && model) {\r\n    return `${model}; Android ${platformVersion}`;\r\n  }\r\n\r\n  const userAgentString = req.headers['user-agent'];\r\n  if (!userAgentString) {\r\n    console.error('No User-Agent header found');\r\n    return 'Unknown Platform';\r\n  }\r\n\r\n  const match = userAgentString.match(/\\(([^)]+)\\)/);\r\n  if (match) {\r\n    const platformInfo = match[1];\r\n    const platformParts = platformInfo.split(';');\r\n    return platformParts.slice(0, 2).join(';');\r\n  }\r\n  return 'Unknown Platform';\r\n}\r\n"],"names":["getBrowserVersion","getDeviceVersion","getUserBrowser","getUserIP","getUserOS","getUserSource","getVersionPlatform","req","userAgentString","headers","console","error","userAgent","useragent","parse","deviceType","isMobile","isTablet","isChromeOS","isMac","isDesktop","isiPad","isLinux","isSmartTV","source","toString","version","browser","connection","remoteAddress","platformVersion","model","match","platformInfo","platformParts","split","slice","join"],"mappings":"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"}