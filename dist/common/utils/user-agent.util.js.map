{"version":3,"sources":["../../../src/common/utils/user-agent.util.ts"],"sourcesContent":["import * as useragent from 'express-useragent';\n\nexport async function getUserOS(req: any) {\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown';\n  }\n\n  const userAgent = useragent.parse(userAgentString);\n  let deviceType;\n\n  switch (true) {\n    case userAgent.isMobile:\n      deviceType = 'Mobile';\n      break;\n    case userAgent.isTablet:\n      deviceType = 'Tablet';\n      break;\n    case userAgent.isChromeOS:\n      deviceType = 'Chrome OS';\n      break;\n    case userAgent.isMac:\n      deviceType = 'macOS';\n      break;\n    case userAgent.isDesktop:\n      deviceType = 'Desktop';\n      break;\n    case userAgent.isiPad:\n      deviceType = 'iPad';\n      break;\n    case userAgent.isLinux:\n      deviceType = 'Linux';\n      break;\n    case userAgent.isSmartTV:\n      deviceType = 'Smart TV';\n      break;\n    default:\n      deviceType = 'Unknown';\n      break;\n  }\n\n  return deviceType;\n}\n\nexport async function getUserSource(req: any) {\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown';\n  }\n\n  const userAgent = useragent.parse(userAgentString);\n  return userAgent.source.toString();\n}\n\nexport async function getDeviceVersion(req: any) {\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown';\n  }\n\n  const userAgent = useragent.parse(userAgentString);\n  return userAgent.version.toString();\n}\n\nexport async function getBrowserVersion(req: any) {\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown';\n  }\n\n  const userAgent = useragent.parse(userAgentString);\n  return `${userAgent.browser}/${userAgent.version}`;\n}\n\nexport async function getUserIP(req: any) {\n  return req.headers['x-forwarded-for'] || req.connection.remoteAddress || 'Unknown';\n}\n\nexport async function getUserBrowser(req: any) {\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown';\n  }\n\n  const userAgent = useragent.parse(userAgentString);\n  return userAgent.browser.toString();\n}\n\nexport async function getVersionPlatform(req: any) {\n  const platformVersion = req.headers['sec-ch-ua-platform-version'];\n  const model = req.headers['sec-ch-ua-model'];\n\n  if (platformVersion && model) {\n    return `${model}; Android ${platformVersion}`;\n  }\n\n  const userAgentString = req.headers['user-agent'];\n  if (!userAgentString) {\n    console.error('No User-Agent header found');\n    return 'Unknown Platform';\n  }\n\n  const match = userAgentString.match(/\\(([^)]+)\\)/);\n  if (match) {\n    const platformInfo = match[1];\n    const platformParts = platformInfo.split(';');\n    return platformParts.slice(0, 2).join(';');\n  }\n  return 'Unknown Platform';\n}\n"],"names":["getBrowserVersion","getDeviceVersion","getUserBrowser","getUserIP","getUserOS","getUserSource","getVersionPlatform","req","userAgentString","headers","console","error","userAgent","useragent","parse","deviceType","isMobile","isTablet","isChromeOS","isMac","isDesktop","isiPad","isLinux","isSmartTV","source","toString","version","browser","connection","remoteAddress","platformVersion","model","match","platformInfo","platformParts","split","slice","join"],"mappings":"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"}