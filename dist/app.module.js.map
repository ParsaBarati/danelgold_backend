{"version":3,"sources":["../src/app.module.ts"],"sourcesContent":["import {MiddlewareConsumer, Module, NestModule} from '@nestjs/common';\r\nimport {APP_FILTER, APP_GUARD, APP_INTERCEPTOR} from '@nestjs/core';\r\nimport {ConfigModule, ConfigService} from '@nestjs/config';\r\nimport {TypeOrmModule} from '@nestjs/typeorm';\r\nimport {ThrottlerModule} from '@nestjs/throttler';\r\nimport {ServeStaticModule} from '@nestjs/serve-static';\r\nimport typeormDataSource from './config/data-source';\r\nimport {join} from 'path';\r\nimport {AppController} from './app.controller';\r\nimport {AppService} from './app.service';\r\nimport {AuthModule} from './user/auth/auth.module';\r\nimport {UserModule} from './user/user/user.module';\r\nimport {SessionModule} from './session/session.module';\r\nimport {SubscribeModule} from './user/subscribe/subscribe.module';\r\nimport {UserDetailModule} from './user/user-detail/userDetail.module';\r\nimport {UploadModule} from './upload/upload.module';\r\nimport {LoggingInterceptor} from './common/utils/logger.interseptor';\r\nimport {AllExceptionsFilter} from './common/exeptionFilters/global.error';\r\nimport {UserAgentMiddleware} from './common/middleware/user-agent.middleware';\r\nimport {AuctionModule} from './market/auction/auction.module';\r\nimport {CollectionEntityModule} from './market/collection/collection.module';\r\nimport {NFTModule} from './nft/nft/nft.module';\r\nimport {ForumModule} from './social/forum/forum.module';\r\nimport {SupportTicketModule} from './social/support-ticket/st/support-ticket.module';\r\nimport {UserService} from './user/user/user.service';\r\nimport {User} from './user/user/entity/user.entity';\r\nimport {SmsService} from './services/sms.service';\r\nimport {IPFSService} from './services/IPFS.service';\r\nimport {PinataModule} from './nft/pinta/pinta.module';\r\nimport {StoriesModule} from './social/story/stories/stories.module';\r\nimport {PostsModule} from './social/post/posts/posts.module';\r\nimport {Story} from './social/story/stories/entity/stories.entity';\r\nimport {Comment} from './social/comment/comment/entity/comment.entity';\r\nimport {Reply} from './social/comment/replyComment/entity/reply.entity';\r\nimport {likeComment} from './social/comment/like-comment/entity/like-comment.entity';\r\nimport {Post} from './social/post/posts/entity/posts.entity';\r\nimport {likePost} from './social/post/like-post/entity/like-post.entity';\r\nimport {likeStory} from './social/story/like-story/entity/like-story.entity';\r\nimport {Club} from './social/club/entity/club.entity';\r\nimport {NotificationModule} from './social/notification/notification.module';\r\nimport {WalletModule} from './nft/wallet/wallet.module';\r\nimport {CryptoEntity} from './nft/crypto/entity/crypto.entity';\r\nimport {FollowUser} from './social/follow/entity/follow.entity';\r\nimport {LikePostModule} from \"@/social/post/like-post/like-post.module\";\r\nimport {SavePostModule} from \"@/social/post/save-post/save-post.module\";\r\nimport {savePost} from \"@/social/post/save-post/entity/save-post.entity\";\r\nimport {LikeStoryModule} from \"@/social/story/like-story/like-story.module\";\r\nimport { Notification } from './social/notification/entity/notification.entity';\r\nimport { NotificationService } from './social/notification/notification.service';\r\nimport { HttpModule } from '@nestjs/axios';\r\nimport { MessageModule } from './social/message/message/message.module';\r\nimport { LikeMessageModule } from './social/message/like-message/like-message.module';\r\nimport { BlockUser } from './social/block/entity/block.entity';\r\nimport { Admin } from './user/admin/entity/admin.entity';\r\nimport { AdminModule } from './user/admin/admin.module';\r\nimport {DashboardModule} from \"./user/dashboard/dashboard.module\";\r\nimport { OtpModule } from '@/user/auth/otp/otp.module';\r\nimport { TokenModule } from '@/user/auth/token/token.module';\r\nimport { RSTModule } from '@/social/support-ticket/rst/rst.module';\r\nimport { JwtStrategy } from '@/user/auth/strategy/jwt.strategy';\r\nimport { JwtAuthGuard } from '@/user/auth/guards/jwt.guard';\r\nimport { RolesGuard } from '@/user/auth/guards/roles.guard';\r\nimport { Token } from '@/user/auth/token/entity/token.entity';\r\n\r\n\r\n\r\n@Module({\r\n    imports: [\r\n        ThrottlerModule.forRoot([\r\n            {\r\n                ttl: 60000,\r\n                limit: 50,\r\n            },\r\n        ]),\r\n        ServeStaticModule.forRoot({\r\n            rootPath: join(__dirname, '..', 'public'),\r\n            serveRoot: '/public',\r\n        }),\r\n        ConfigModule.forRoot({\r\n            envFilePath: '.env',\r\n        }),\r\n        TypeOrmModule.forRootAsync({\r\n            imports: [ConfigModule],\r\n            inject: [ConfigService],\r\n\r\n            useFactory: (configService: ConfigService) => {\r\n                const synchronize = configService.get('NODE_ENV') === 'development';\r\n\r\n                console.log('synchronize ' + synchronize);\r\n                console.log(typeormDataSource.options);\r\n\r\n\r\n                return {\r\n                    ...typeormDataSource.options,\r\n                    autoLoadEntities: true,\r\n                    connectTimeoutMS: 30000,\r\n                };\r\n            },\r\n        }),\r\n        TypeOrmModule.forFeature([\r\n            User,\r\n            Admin,\r\n            Token,\r\n            Club,\r\n            Story,\r\n            Comment,\r\n            likeComment,\r\n            Reply,\r\n            Post,\r\n            likePost,\r\n            likeStory,\r\n            CryptoEntity,\r\n            FollowUser,\r\n            BlockUser,\r\n            savePost,\r\n            Notification,\r\n        ]),\r\n        AuctionModule,\r\n        CollectionEntityModule,\r\n        NFTModule,\r\n        ForumModule,\r\n        SupportTicketModule,\r\n        AuthModule,\r\n        AdminModule,\r\n        UserModule,\r\n        UserDetailModule,\r\n        OtpModule,\r\n        SessionModule,\r\n        UploadModule,\r\n        SubscribeModule,\r\n        TokenModule,\r\n        PinataModule,\r\n        StoriesModule,\r\n        PostsModule,\r\n        LikePostModule,\r\n        LikeStoryModule,\r\n        SavePostModule,\r\n        RSTModule,\r\n        MessageModule,\r\n        LikeMessageModule,\r\n        NotificationModule,\r\n        WalletModule,\r\n        DashboardModule,\r\n        {\r\n            global: true,\r\n            ...HttpModule.register({maxRedirects: 5}),\r\n        }\r\n\r\n    ],\r\n    controllers: [AppController,],\r\n    providers: [\r\n        AppService,\r\n        UserService,\r\n        IPFSService,\r\n        SmsService,\r\n        JwtStrategy,\r\n        NotificationService,\r\n        {\r\n            provide: APP_GUARD,\r\n            useClass: JwtAuthGuard,\r\n        },\r\n        {\r\n            provide: APP_GUARD,\r\n            useClass: RolesGuard,\r\n        },\r\n        {\r\n            provide: APP_INTERCEPTOR,\r\n            useClass: LoggingInterceptor,\r\n        },\r\n        {\r\n            provide: APP_FILTER,\r\n            useClass: AllExceptionsFilter,\r\n        },\r\n    ],\r\n    exports: [IPFSService, HttpModule]\r\n})\r\nexport class AppModule implements NestModule {\r\n    configure(consumer: MiddlewareConsumer) {\r\n        consumer.apply(UserAgentMiddleware).forRoutes('*');\r\n    }\r\n}\r\n"],"names":["AppModule","configure","consumer","apply","UserAgentMiddleware","forRoutes","imports","ThrottlerModule","forRoot","ttl","limit","ServeStaticModule","rootPath","join","__dirname","serveRoot","ConfigModule","envFilePath","TypeOrmModule","forRootAsync","inject","ConfigService","useFactory","configService","synchronize","get","console","log","typeormDataSource","options","autoLoadEntities","connectTimeoutMS","forFeature","User","Admin","Token","Club","Story","Comment","likeComment","Reply","Post","likePost","likeStory","CryptoEntity","FollowUser","BlockUser","savePost","Notification","AuctionModule","CollectionEntityModule","NFTModule","ForumModule","SupportTicketModule","AuthModule","AdminModule","UserModule","UserDetailModule","OtpModule","SessionModule","UploadModule","SubscribeModule","TokenModule","PinataModule","StoriesModule","PostsModule","LikePostModule","LikeStoryModule","SavePostModule","RSTModule","MessageModule","LikeMessageModule","NotificationModule","WalletModule","DashboardModule","global","HttpModule","register","maxRedirects","controllers","AppController","providers","AppService","UserService","IPFSService","SmsService","JwtStrategy","NotificationService","provide","APP_GUARD","useClass","JwtAuthGuard","RolesGuard","APP_INTERCEPTOR","LoggingInterceptor","APP_FILTER","AllExceptionsFilter","exports"],"mappings":"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"}